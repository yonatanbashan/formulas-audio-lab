{"version":3,"file":"recorder.worklet-CxQzUy21.js","sources":["../src/audio/worklets/recorder.worklet.ts"],"sourcesContent":["/**\n * Recorder AudioWorklet Processor\n * Captures raw PCM samples for WAV export\n */\n\ntype RecorderMessage = { type: 'start' } | { type: 'stop' };\n\nclass RecorderProcessor extends AudioWorkletProcessor {\n  private recording: boolean = false;\n  private chunks: Float32Array[] = [];\n\n  constructor() {\n    super();\n\n    this.port.onmessage = (e: MessageEvent<RecorderMessage>) => {\n      if (e.data.type === 'start') {\n        this.recording = true;\n        this.chunks = [];\n      } else if (e.data.type === 'stop') {\n        this.recording = false;\n        const totalLength = this.chunks.reduce((acc, c) => acc + c.length, 0);\n        const result = new Float32Array(totalLength);\n        let offset = 0;\n        for (const chunk of this.chunks) {\n          result.set(chunk, offset);\n          offset += chunk.length;\n        }\n        this.port.postMessage({ type: 'data', samples: result });\n        this.chunks = [];\n      }\n    };\n  }\n\n  process(\n    inputs: Float32Array[][],\n    outputs: Float32Array[][],\n    _parameters: Record<string, Float32Array>\n  ): boolean {\n    const input = inputs[0];\n    const output = outputs[0];\n\n    // Pass through audio (keeps node active in audio graph)\n    if (input && input[0] && output && output[0]) {\n      output[0].set(input[0]);\n\n      // Record if active\n      if (this.recording) {\n        this.chunks.push(new Float32Array(input[0]));\n      }\n    }\n\n    return true;\n  }\n}\n\nregisterProcessor('recorder-processor', RecorderProcessor);\n"],"names":["RecorderProcessor","totalLength","acc","result","offset","chunk","inputs","outputs","_parameters","input","output"],"mappings":"AAOA,MAAMA,UAA0B,qBAAsB,CAIpD,aAAc,CACZ,MAAA,EAJF,KAAQ,UAAqB,GAC7B,KAAQ,OAAyB,CAAA,EAK/B,KAAK,KAAK,UAAa,GAAqC,CAC1D,GAAI,EAAE,KAAK,OAAS,QAClB,KAAK,UAAY,GACjB,KAAK,OAAS,CAAA,UACL,EAAE,KAAK,OAAS,OAAQ,CACjC,KAAK,UAAY,GACjB,MAAMC,EAAc,KAAK,OAAO,OAAO,CAACC,EAAK,IAAMA,EAAM,EAAE,OAAQ,CAAC,EAC9DC,EAAS,IAAI,aAAaF,CAAW,EAC3C,IAAIG,EAAS,EACb,UAAWC,KAAS,KAAK,OACvBF,EAAO,IAAIE,EAAOD,CAAM,EACxBA,GAAUC,EAAM,OAElB,KAAK,KAAK,YAAY,CAAE,KAAM,OAAQ,QAASF,EAAQ,EACvD,KAAK,OAAS,CAAA,CAChB,CACF,CACF,CAEA,QACEG,EACAC,EACAC,EACS,CACT,MAAMC,EAAQH,EAAO,CAAC,EAChBI,EAASH,EAAQ,CAAC,EAGxB,OAAIE,GAASA,EAAM,CAAC,GAAKC,GAAUA,EAAO,CAAC,IACzCA,EAAO,CAAC,EAAE,IAAID,EAAM,CAAC,CAAC,EAGlB,KAAK,WACP,KAAK,OAAO,KAAK,IAAI,aAAaA,EAAM,CAAC,CAAC,CAAC,GAIxC,EACT,CACF,CAEA,kBAAkB,qBAAsBT,CAAiB"}